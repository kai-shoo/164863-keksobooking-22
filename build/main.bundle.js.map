{"version":3,"sources":["webpack://keksobooking/./source/js/util.js","webpack://keksobooking/./source/js/model.js","webpack://keksobooking/./source/js/views/map-view.js","webpack://keksobooking/./source/js/views/form-view.js","webpack://keksobooking/./source/js/views/marker-view.js","webpack://keksobooking/./source/js/views/popup-view.js","webpack://keksobooking/./source/js/views/page-view.js","webpack://keksobooking/./source/js/views/filter-view.js","webpack://keksobooking/./node_modules/lodash-es/isObject.js","webpack://keksobooking/./node_modules/lodash-es/_freeGlobal.js","webpack://keksobooking/./node_modules/lodash-es/_root.js","webpack://keksobooking/./node_modules/lodash-es/now.js","webpack://keksobooking/./node_modules/lodash-es/_trimmedEndIndex.js","webpack://keksobooking/./node_modules/lodash-es/_baseTrim.js","webpack://keksobooking/./node_modules/lodash-es/_Symbol.js","webpack://keksobooking/./node_modules/lodash-es/_getRawTag.js","webpack://keksobooking/./node_modules/lodash-es/_objectToString.js","webpack://keksobooking/./node_modules/lodash-es/_baseGetTag.js","webpack://keksobooking/./node_modules/lodash-es/toNumber.js","webpack://keksobooking/./node_modules/lodash-es/isSymbol.js","webpack://keksobooking/./node_modules/lodash-es/isObjectLike.js","webpack://keksobooking/./node_modules/lodash-es/debounce.js","webpack://keksobooking/./source/js/main.js"],"names":["AJAX","async","url","uploadData","fetchPro","fetch","method","body","res","Promise","race","_","reject","setTimeout","Error","data","json","ok","message","status","URL","state","LAT","LNG","parentEl","document","querySelector","filter","centerMap","map","setView","lat","lng","L","tileLayer","attribution","addTo","createMap","markerMain","marker","draggable","markerGroup","featureGroup","SPECIAL_ROOM_NUMBER","FILE_TYPES","typeToMinPrice","bungalow","flat","house","palace","fieldsets","querySelectorAll","filterContainer","filters","features","titleInput","addressInput","typeInput","priceInput","timeinInput","timeoutInput","avatarInput","avatarPreview","imagesInput","imagesPreview","capacityInput","capacityOptions","roomInput","buttonReset","renderImagePreview","preview","file","this","files","console","log","fileName","name","toLowerCase","some","it","endsWith","reader","FileReader","addEventListener","setAttribute","src","result","readAsDataURL","validateTitle","setCustomValidity","validity","valid","tooShort","tooLong","valueMissing","reportValidity","toggleForbiddenOptions","forEach","option","value","disabled","dataset","isDisabled","validateGuests","addHandlerButtonReset","handler","validatePrice","rangeUnderflow","getAttribute","rangeOverflow","badInput","toggleFormsEnability","classList","toggle","fieldset","refresh","reset","selected","minPrice","input","bind","ICON_MAIN_PIN","iconUrl","iconSize","iconAnchor","ICON_PIN","popupAnchor","renderMarkers","ad","location","createMarker","icon","TYPE","template","content","renderMessage","fragment","createDocumentFragment","appendChild","cloneNode","focus","remove","evt","key","filtersForm","type","rooms","guests","price","featuresFieldset","PRICE_TO_RANGE","any","low","middle","high","global","Object","freeSelf","self","Function","reWhitespace","reTrimStart","string","slice","index","length","test","charAt","replace","objectProto","prototype","hasOwnProperty","nativeObjectToString","toString","symToStringTag","undefined","isOwn","call","tag","unmasked","e","reIsBadHex","reIsBinary","reIsOctal","freeParseInt","parseInt","other","valueOf","isBinary","nativeMax","Math","max","nativeMin","min","window","setIcon","on","event","clickedMarker","propagatedFrom","clickedAd","getLatLng","popup","author","avatar","textContent","offer","title","address","checkin","checkout","featuresNodes","featuresClasses","feature","array","element","className","includes","description","photoTemplate","photoContainer","photos","photo","newPhoto","append","generateMarkup","bindPopup","togglePopup","unbindPopup","coords","toFixed","ads","err","currentAds","innerHTML","insertAdjacentHTML","preventDefault","FormData","target","func","wait","options","lastArgs","lastThis","maxWait","timerId","lastCallTime","lastInvokeTime","leading","maxing","trailing","TypeError","invokeFunc","time","args","thisArg","apply","leadingEdge","timerExpired","shouldInvoke","timeSinceLastCall","trailingEdge","timeWaiting","remainingWait","debounced","isInvoking","arguments","clearTimeout","cancel","flush","filterMask","checkedFeatures","Array","from","filteredAds","mask","every"],"mappings":"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","file":"main.bundle.js","sourcesContent":["/*eslint-disable  indent*/\n\nconst TIMEOUT = 10000;\n\nconst keepElementsByClassFromArr = function (array, elements) {\n  elements.forEach((element) => {\n    if (\n      !array.some((className) => element.className.includes(`${className}`))\n    ) {\n      element.remove();\n    }\n  });\n};\n\nconst timeout = function (s) {\n  return new Promise(function (_, reject) {\n    setTimeout(function () {\n      reject(\n        new Error(\n          `Запрос выполняется слишком долго! Прервано после ${s} секунд`,\n        ),\n      );\n    }, s);\n  });\n};\n\nconst AJAX = async function (url, uploadData = undefined) {\n  const fetchPro = uploadData\n    ? fetch(url, {\n        method: 'POST',\n        body: uploadData,\n      })\n    : fetch(url);\n\n  const res = await Promise.race([fetchPro, timeout(TIMEOUT)]);\n\n  const data = await res.json();\n\n  if (!res.ok) {\n    throw new Error(`${data.message} (${res.status})`);\n  }\n  return data;\n};\n\nexport { keepElementsByClassFromArr, AJAX };\n","/*eslint-disable  no-useless-catch*/\n\nimport { AJAX } from './util.js';\n\nconst URL = 'https://22.javascript.pages.academy/keksobooking';\n\nexport const state = {};\n\nexport const loadAds = async function () {\n  try {\n    const data = await AJAX(`${URL}/data`);\n    state.ads = data;\n  } catch (err) {\n    throw err;\n  }\n};\n\nexport const sendAds = function (data) {\n  try {\n    return AJAX(URL, data);\n  } catch (err) {\n    throw err;\n  }\n};\n\nexport const filterAds = function (mask) {\n  const filteredData = state.ads.filter((ad) => {\n    if (ad.offer.type && ad.offer.type !== mask.type && mask.type !== 'any') {\n      return false;\n    }\n\n    if (\n      ad.offer.rooms &&\n      ad.offer.rooms !== +mask.rooms &&\n      mask.rooms !== 'any'\n    ) {\n      return false;\n    }\n\n    if (\n      ad.offer.guests &&\n      ad.offer.guests !== +mask.guests &&\n      mask.guests !== 'any'\n    ) {\n      return false;\n    }\n\n    if (\n      ad.offer.price &&\n      (ad.offer.price < mask.price[0] || ad.offer.price > mask.price[1])\n    ) {\n      return false;\n    }\n\n    if (ad.offer.features.length !== 0 && mask.features.length !== 0) {\n      const isContainsAllFeature = mask.features.every((feature) => {\n        return ad.offer.features.includes(feature);\n      });\n\n      return isContainsAllFeature;\n    }\n\n    return true;\n  });\n  return filteredData;\n};\n","/* global L:readonly */\n\nexport const LAT = 35.6817;\nexport const LNG = 139.753882;\nconst ZOOM = 10;\nconst parentEl = document.querySelector('#map-canvas');\nconst filter = document.querySelector('.map__filters-container');\n\nexport const addHandlerLoad = function (handler) {\n  window.addEventListener('DOMContentLoaded', handler);\n};\n\nexport const addHandlerAttachInput = function (handler) {\n  markerMain.on('move add', handler);\n};\n\nexport const addHandlerRenderMarker = function (handler) {\n  map.on('load', handler);\n};\n\nconst createMap = function () {\n  const map = L.map(parentEl);\n  L.tileLayer('https://{s}.tile.openstreetmap.fr/hot/{z}/{x}/{y}.png', {\n    attribution:\n      '&copy; <a href=\"https://www.openstreetmap.org/copyright\">OpenStreetMap</a> contributors',\n  }).addTo(map);\n\n  return map;\n};\n\nexport const centerMap = function () {\n  map.setView(\n    {\n      lat: LAT,\n      lng: LNG,\n    },\n    ZOOM,\n  );\n};\n\nexport const addToGroup = function (item) {\n  item.addTo(markerGroup);\n};\n\nexport const renderErrorLoadAds = function () {\n  const markup = `\n    <div class=\"error__message-marker\">\n      <p>Ошибка загрузки!</p>\n    </div>`;\n  filter.innerHTML = '';\n  filter.insertAdjacentHTML('afterbegin', markup);\n};\n\nexport const map = createMap();\nexport const markerMain = L.marker({ lat: LAT, lng: LNG }, { draggable: true });\nexport const markerGroup = L.featureGroup().addTo(map);\n","const SPECIAL_ROOM_NUMBER = '100';\nconst FILE_TYPES = ['gif', 'jpg', 'jpeg', 'png'];\n\nconst typeToMinPrice = {\n  bungalow: 0,\n  flat: 1000,\n  house: 5000,\n  palace: 10000,\n};\n\nconst parentEl = document.querySelector('.ad-form');\nconst fieldsets = document.querySelectorAll('.ad-form__element');\nconst filterContainer = document.querySelector('.map__filters');\nconst filters = document.querySelectorAll('.map__filter');\nconst features = document.querySelector('.map__features');\n\nconst titleInput = document.querySelector('#title');\nconst addressInput = document.querySelector('#address');\nconst typeInput = document.querySelector('#type');\nconst priceInput = document.querySelector('#price');\nconst timeinInput = document.querySelector('#timein');\nconst timeoutInput = document.querySelector('#timeout');\n\nconst avatarInput = document.querySelector('#avatar');\nconst avatarPreview = document.querySelector('.ad-form-header__preview > img');\nconst imagesInput = document.querySelector('#images');\nconst imagesPreview = document.querySelector('.ad-form__photo > img');\n\nconst capacityInput = document.querySelector('#capacity');\nconst capacityOptions = capacityInput.querySelectorAll('option');\nconst roomInput = document.querySelector('#room_number');\n\nconst buttonReset = document.querySelector('.ad-form__reset');\n\nexport const addHandlerToggle = function (handler) {\n  window.addEventListener('DOMContentLoaded', handler);\n};\n\nconst addHandlerTitleValidity = function () {\n  titleInput.addEventListener('focus', validateTitle);\n  titleInput.addEventListener('input', validateTitle);\n};\n\nconst addHandlerAvatarUpload = function () {\n  avatarInput.addEventListener(\n    'change',\n    renderImagePreview.bind(avatarInput, avatarPreview),\n  );\n};\n\nconst addHandlerImagesUpload = function () {\n  imagesInput.addEventListener(\n    'change',\n    renderImagePreview.bind(imagesInput, imagesPreview),\n  );\n};\n\nconst renderImagePreview = function (preview) {\n  const file = this.files[0];\n  console.log(file);\n  const fileName = file.name.toLowerCase();\n\n  const isMatch = FILE_TYPES.some((it) => {\n    return fileName.endsWith(it);\n  });\n\n  if (isMatch) {\n    const reader = new FileReader();\n\n    reader.addEventListener('load', () => {\n      preview.setAttribute('width', '40');\n      preview.setAttribute('height', '44');\n      preview.src = reader.result;\n    });\n\n    reader.readAsDataURL(file);\n  }\n};\n\nconst validateTitle = function () {\n  titleInput.setCustomValidity('');\n  if (titleInput.validity.valid) {\n    return;\n  }\n\n  if (titleInput.validity.tooShort) {\n    titleInput.setCustomValidity(\n      'Заголовок должнен состоять минимум из 30-ти символов',\n    );\n  }\n  if (titleInput.validity.tooLong) {\n    titleInput.setCustomValidity(\n      `Заголовок не должен превышать ${SPECIAL_ROOM_NUMBER} символов`,\n    );\n  }\n  if (titleInput.validity.valueMissing) {\n    titleInput.setCustomValidity('Обязательное поле');\n  }\n\n  titleInput.reportValidity();\n};\n\nconst addHandlerGuestsValidity = function () {\n  roomInput.addEventListener('change', () => {\n    toggleForbiddenOptions();\n    validateGuests();\n  });\n\n  capacityInput.addEventListener('change', () => {\n    toggleForbiddenOptions();\n    validateGuests();\n  });\n};\n\nconst toggleForbiddenOptions = function () {\n  capacityOptions.forEach((option) => {\n    if (roomInput.value === SPECIAL_ROOM_NUMBER) {\n      option.disabled = option.value !== '0' ? true : false;\n    }\n\n    if (roomInput.value !== SPECIAL_ROOM_NUMBER) {\n      option.disabled = roomInput.value < option.value ? true : false;\n      if (option.value === '0') {\n        option.disabled = true;\n      }\n    }\n\n    if (capacityInput.value === option.value) {\n      capacityInput.dataset.isDisabled = option.disabled;\n    }\n  });\n};\n\nconst validateGuests = function () {\n  if (capacityInput.dataset.isDisabled === 'true') {\n    capacityInput.setCustomValidity(\n      'Комнат должно быть больше или столько же сколько гостей',\n    );\n\n    if (roomInput.value === SPECIAL_ROOM_NUMBER) {\n      capacityInput.setCustomValidity(\n        `${SPECIAL_ROOM_NUMBER} комнат может быть только \"для не гостей\"`,\n      );\n    }\n\n    capacityInput.reportValidity();\n  }\n\n  if (capacityInput.dataset.isDisabled === 'false') {\n    capacityInput.setCustomValidity('');\n  }\n};\n\nconst addHandlerPriceValidity = function () {\n  priceInput.addEventListener('input', validatePrice);\n  priceInput.addEventListener('focus', validatePrice);\n};\n\nexport const addHandlerButtonReset = function (handler) {\n  buttonReset.addEventListener('click', handler);\n};\n\nconst validatePrice = function () {\n  priceInput.setCustomValidity('');\n  if (priceInput.validity.valid) {\n    return;\n  }\n\n  if (priceInput.validity.rangeUnderflow) {\n    priceInput.setCustomValidity(\n      `Цена не должна быть меньше ${priceInput.getAttribute('min')}`,\n    );\n  }\n  if (priceInput.validity.rangeOverflow) {\n    priceInput.setCustomValidity('Цена не должна превышать 1000000');\n  }\n  if (priceInput.validity.valueMissing) {\n    priceInput.setCustomValidity('Обязательное поле');\n  }\n  if (priceInput.validity.badInput) {\n    priceInput.setCustomValidity('Цена должна быть числом');\n  }\n\n  priceInput.reportValidity();\n};\n\nconst addHandlerChangeTime = function () {\n  [timeinInput, timeoutInput].forEach((input) =>\n    input.addEventListener('change', () => {\n      timeinInput.value = timeoutInput.value = input.value;\n    }),\n  );\n};\n\nconst addHandlerChangeType = function () {\n  typeInput.addEventListener('change', () => {\n    const selected = typeInput.value;\n    const minPrice = typeToMinPrice[selected];\n    priceInput.setAttribute('min', minPrice);\n    priceInput.setAttribute('placeholder', minPrice);\n    validatePrice();\n  });\n};\n\nexport const toggleFormsEnability = function () {\n  parentEl.classList.toggle('ad-form--disabled');\n  fieldsets.forEach((fieldset) => (fieldset.disabled = !fieldset.disabled));\n\n  filterContainer.classList.toggle('map__filters--disabled');\n  features.disabled = !features.disabled;\n  filters.forEach((filter) => (filter.disabled = !filter.disabled));\n};\n\nexport const setAddressValue = function (coords) {\n  const { lat, lng } = coords;\n  addressInput.value = `${lat.toFixed(5)}, ${lng.toFixed(5)}`;\n};\n\nexport const addHandlerSubmit = function (handler) {\n  parentEl.addEventListener('submit', handler);\n};\n\nexport const refresh = function () {\n  parentEl.reset();\n};\n\ntoggleFormsEnability();\naddressInput.setAttribute('readonly', 'readonly');\n\ntoggleForbiddenOptions();\n\naddHandlerChangeType();\naddHandlerChangeTime();\n\naddHandlerTitleValidity();\naddHandlerPriceValidity();\naddHandlerGuestsValidity();\naddHandlerButtonReset();\naddHandlerAvatarUpload();\naddHandlerImagesUpload();\n","/* eslint-disable no-undef */\nimport { map, markerGroup, addToGroup } from './map-view.js';\n\nexport const markers = [];\n\nconst ICON_MAIN_PIN = {\n  iconUrl: './img/main-pin.svg',\n  iconSize: [25, 41],\n  iconAnchor: [12, 41],\n};\nconst ICON_PIN = {\n  iconUrl: './img/pin.svg',\n  iconSize: [25, 41],\n  iconAnchor: [12, 41],\n  popupAnchor: [0, -31],\n};\n\nexport const addHandlerShowPopup = function (handler) {\n  markerGroup.on('click', handler);\n};\n\nexport const bindPopup = function (popup) {\n  marker.bindPopup(popup);\n};\n\nexport const togglePopup = function (marker) {\n  marker.getPopup().togglePopup();\n};\n\nexport const renderMarkerMain = function (marker) {\n  marker.setIcon(L.icon(ICON_MAIN_PIN)).addTo(map);\n};\n\nexport const renderMarkers = function (data) {\n  data.forEach((ad) => {\n    const { lat, lng } = ad.location;\n    const marker = createMarker(lat, lng);\n    addToGroup(marker);\n  });\n};\n\nexport const createMarker = function (lat, lng) {\n  const marker = L.marker(\n    { lat: lat, lng: lng },\n    {\n      icon: L.icon(ICON_PIN),\n    },\n  );\n\n  return marker;\n};\n","import { keepElementsByClassFromArr } from '../util.js';\n\nconst TYPE = {\n  flat: 'Квартира',\n  bungalow: 'Бунгало',\n  house: 'Дом',\n  palace: 'Дворец',\n};\n\nconst template = document\n  .querySelector('#card')\n  .content.querySelector('.popup');\n\nexport const renderPopup = function (marker, ad) {\n  const popup = generateMarkup(ad);\n\n  marker.bindPopup(popup).togglePopup();\n  marker.unbindPopup();\n};\n\nconst generateMarkup = function (data) {\n  const fragment = document.createDocumentFragment();\n\n  const popup = template.cloneNode(true);\n\n  popup.querySelector('.popup__avatar').src = data.author.avatar;\n  popup.querySelector('.popup__title').textContent = data.offer.title;\n  popup.querySelector('.popup__text--address').textContent = data.offer.address;\n  popup.querySelector('.popup__text--price').textContent = data.offer.price;\n  popup.querySelector('.popup__type').textContent = TYPE[data.offer.type];\n\n  popup.querySelector(\n    '.popup__text--capacity',\n  ).textContent = `${data.offer.rooms} комнаты для ${data.offer.guests} гостей.`;\n\n  popup.querySelector(\n    '.popup__text--time',\n  ).textContent = `Заезд после ${data.offer.checkin}, выезд до ${data.offer.checkout}`;\n\n  const featuresNodes = popup.querySelectorAll('.popup__feature');\n\n  if (data.offer.features === 0) {\n    featuresNodes.remove();\n  }\n\n  if (data.offer.features.length !== 0) {\n    const featuresClasses = data.offer.features.map(\n      (feature) => `popup__feature popup__feature--${feature}`,\n    );\n    keepElementsByClassFromArr(featuresClasses, featuresNodes);\n  }\n\n  popup.querySelector('.popup__description').textContent =\n    data.offer.description;\n\n  const photoTemplate = popup.querySelector('.popup__photo');\n  photoTemplate.remove();\n\n  const photoContainer = popup.querySelector('.popup__photos');\n  data.offer.photos.forEach((photo) => {\n    const newPhoto = photoTemplate.cloneNode();\n    newPhoto.src = `${photo}`;\n    photoContainer.appendChild(newPhoto);\n  });\n\n  fragment.append(popup);\n\n  return fragment;\n};\n","const renderMessage = function (name) {\n  const template = document\n    .querySelector(`#${name}`)\n    .content.querySelector(`.${name}`);\n\n  const fragment = document.createDocumentFragment();\n  fragment.appendChild(template.cloneNode(true));\n  document.querySelector('main').appendChild(fragment);\n\n  const message = document.querySelector(`.${name}`);\n  message.focus();\n\n  message.addEventListener('click', () => {\n    document.querySelector(`.${name}`).remove();\n  });\n  message.addEventListener('keydown', function removeModal(evt) {\n    if (evt.key === 'Escape') {\n      document.querySelector(`.${name}`).remove();\n    }\n  });\n};\n\nexport const renderSuccess = function () {\n  renderMessage('success');\n};\n\nexport const renderError = function () {\n  renderMessage('error');\n};\n","const filtersForm = document.querySelector('.map__filters');\nconst type = document.querySelector('#housing-type');\nconst rooms = document.querySelector('#housing-rooms');\nconst guests = document.querySelector('#housing-guests');\nconst price = document.querySelector('#housing-price');\nconst featuresFieldset = document.querySelector('#housing-features');\n\nconst PRICE_TO_RANGE = {\n  any: [0],\n  low: [0, 10000],\n  middle: [10000, 50000],\n  high: [50000],\n};\n\nexport const addHandlerChange = function (handler) {\n  filtersForm.addEventListener('change', handler);\n  filtersForm.addEventListener('reset', handler);\n};\n\nexport const getFilterMask = function () {\n  const checkedFeatures = Array.from(\n    featuresFieldset.querySelectorAll(':checked'),\n  ).map((feature) => feature.value);\n\n  return {\n    price: PRICE_TO_RANGE[price.value],\n    type: type.value,\n    rooms: rooms.value,\n    guests: guests.value,\n    features: checkedFeatures,\n  };\n};\n\nexport const refresh = function () {\n  filtersForm.reset();\n};\n","/**\n * Checks if `value` is the\n * [language type](http://www.ecma-international.org/ecma-262/7.0/#sec-ecmascript-language-types)\n * of `Object`. (e.g. arrays, functions, objects, regexes, `new Number(0)`, and `new String('')`)\n *\n * @static\n * @memberOf _\n * @since 0.1.0\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is an object, else `false`.\n * @example\n *\n * _.isObject({});\n * // => true\n *\n * _.isObject([1, 2, 3]);\n * // => true\n *\n * _.isObject(_.noop);\n * // => true\n *\n * _.isObject(null);\n * // => false\n */\nfunction isObject(value) {\n  var type = typeof value;\n  return value != null && (type == 'object' || type == 'function');\n}\n\nexport default isObject;\n","/** Detect free variable `global` from Node.js. */\nvar freeGlobal = typeof global == 'object' && global && global.Object === Object && global;\n\nexport default freeGlobal;\n","import freeGlobal from './_freeGlobal.js';\n\n/** Detect free variable `self`. */\nvar freeSelf = typeof self == 'object' && self && self.Object === Object && self;\n\n/** Used as a reference to the global object. */\nvar root = freeGlobal || freeSelf || Function('return this')();\n\nexport default root;\n","import root from './_root.js';\n\n/**\n * Gets the timestamp of the number of milliseconds that have elapsed since\n * the Unix epoch (1 January 1970 00:00:00 UTC).\n *\n * @static\n * @memberOf _\n * @since 2.4.0\n * @category Date\n * @returns {number} Returns the timestamp.\n * @example\n *\n * _.defer(function(stamp) {\n *   console.log(_.now() - stamp);\n * }, _.now());\n * // => Logs the number of milliseconds it took for the deferred invocation.\n */\nvar now = function() {\n  return root.Date.now();\n};\n\nexport default now;\n","/** Used to match a single whitespace character. */\nvar reWhitespace = /\\s/;\n\n/**\n * Used by `_.trim` and `_.trimEnd` to get the index of the last non-whitespace\n * character of `string`.\n *\n * @private\n * @param {string} string The string to inspect.\n * @returns {number} Returns the index of the last non-whitespace character.\n */\nfunction trimmedEndIndex(string) {\n  var index = string.length;\n\n  while (index-- && reWhitespace.test(string.charAt(index))) {}\n  return index;\n}\n\nexport default trimmedEndIndex;\n","import trimmedEndIndex from './_trimmedEndIndex.js';\n\n/** Used to match leading whitespace. */\nvar reTrimStart = /^\\s+/;\n\n/**\n * The base implementation of `_.trim`.\n *\n * @private\n * @param {string} string The string to trim.\n * @returns {string} Returns the trimmed string.\n */\nfunction baseTrim(string) {\n  return string\n    ? string.slice(0, trimmedEndIndex(string) + 1).replace(reTrimStart, '')\n    : string;\n}\n\nexport default baseTrim;\n","import root from './_root.js';\n\n/** Built-in value references. */\nvar Symbol = root.Symbol;\n\nexport default Symbol;\n","import Symbol from './_Symbol.js';\n\n/** Used for built-in method references. */\nvar objectProto = Object.prototype;\n\n/** Used to check objects for own properties. */\nvar hasOwnProperty = objectProto.hasOwnProperty;\n\n/**\n * Used to resolve the\n * [`toStringTag`](http://ecma-international.org/ecma-262/7.0/#sec-object.prototype.tostring)\n * of values.\n */\nvar nativeObjectToString = objectProto.toString;\n\n/** Built-in value references. */\nvar symToStringTag = Symbol ? Symbol.toStringTag : undefined;\n\n/**\n * A specialized version of `baseGetTag` which ignores `Symbol.toStringTag` values.\n *\n * @private\n * @param {*} value The value to query.\n * @returns {string} Returns the raw `toStringTag`.\n */\nfunction getRawTag(value) {\n  var isOwn = hasOwnProperty.call(value, symToStringTag),\n      tag = value[symToStringTag];\n\n  try {\n    value[symToStringTag] = undefined;\n    var unmasked = true;\n  } catch (e) {}\n\n  var result = nativeObjectToString.call(value);\n  if (unmasked) {\n    if (isOwn) {\n      value[symToStringTag] = tag;\n    } else {\n      delete value[symToStringTag];\n    }\n  }\n  return result;\n}\n\nexport default getRawTag;\n","/** Used for built-in method references. */\nvar objectProto = Object.prototype;\n\n/**\n * Used to resolve the\n * [`toStringTag`](http://ecma-international.org/ecma-262/7.0/#sec-object.prototype.tostring)\n * of values.\n */\nvar nativeObjectToString = objectProto.toString;\n\n/**\n * Converts `value` to a string using `Object.prototype.toString`.\n *\n * @private\n * @param {*} value The value to convert.\n * @returns {string} Returns the converted string.\n */\nfunction objectToString(value) {\n  return nativeObjectToString.call(value);\n}\n\nexport default objectToString;\n","import Symbol from './_Symbol.js';\nimport getRawTag from './_getRawTag.js';\nimport objectToString from './_objectToString.js';\n\n/** `Object#toString` result references. */\nvar nullTag = '[object Null]',\n    undefinedTag = '[object Undefined]';\n\n/** Built-in value references. */\nvar symToStringTag = Symbol ? Symbol.toStringTag : undefined;\n\n/**\n * The base implementation of `getTag` without fallbacks for buggy environments.\n *\n * @private\n * @param {*} value The value to query.\n * @returns {string} Returns the `toStringTag`.\n */\nfunction baseGetTag(value) {\n  if (value == null) {\n    return value === undefined ? undefinedTag : nullTag;\n  }\n  return (symToStringTag && symToStringTag in Object(value))\n    ? getRawTag(value)\n    : objectToString(value);\n}\n\nexport default baseGetTag;\n","import baseTrim from './_baseTrim.js';\nimport isObject from './isObject.js';\nimport isSymbol from './isSymbol.js';\n\n/** Used as references for various `Number` constants. */\nvar NAN = 0 / 0;\n\n/** Used to detect bad signed hexadecimal string values. */\nvar reIsBadHex = /^[-+]0x[0-9a-f]+$/i;\n\n/** Used to detect binary string values. */\nvar reIsBinary = /^0b[01]+$/i;\n\n/** Used to detect octal string values. */\nvar reIsOctal = /^0o[0-7]+$/i;\n\n/** Built-in method references without a dependency on `root`. */\nvar freeParseInt = parseInt;\n\n/**\n * Converts `value` to a number.\n *\n * @static\n * @memberOf _\n * @since 4.0.0\n * @category Lang\n * @param {*} value The value to process.\n * @returns {number} Returns the number.\n * @example\n *\n * _.toNumber(3.2);\n * // => 3.2\n *\n * _.toNumber(Number.MIN_VALUE);\n * // => 5e-324\n *\n * _.toNumber(Infinity);\n * // => Infinity\n *\n * _.toNumber('3.2');\n * // => 3.2\n */\nfunction toNumber(value) {\n  if (typeof value == 'number') {\n    return value;\n  }\n  if (isSymbol(value)) {\n    return NAN;\n  }\n  if (isObject(value)) {\n    var other = typeof value.valueOf == 'function' ? value.valueOf() : value;\n    value = isObject(other) ? (other + '') : other;\n  }\n  if (typeof value != 'string') {\n    return value === 0 ? value : +value;\n  }\n  value = baseTrim(value);\n  var isBinary = reIsBinary.test(value);\n  return (isBinary || reIsOctal.test(value))\n    ? freeParseInt(value.slice(2), isBinary ? 2 : 8)\n    : (reIsBadHex.test(value) ? NAN : +value);\n}\n\nexport default toNumber;\n","import baseGetTag from './_baseGetTag.js';\nimport isObjectLike from './isObjectLike.js';\n\n/** `Object#toString` result references. */\nvar symbolTag = '[object Symbol]';\n\n/**\n * Checks if `value` is classified as a `Symbol` primitive or object.\n *\n * @static\n * @memberOf _\n * @since 4.0.0\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is a symbol, else `false`.\n * @example\n *\n * _.isSymbol(Symbol.iterator);\n * // => true\n *\n * _.isSymbol('abc');\n * // => false\n */\nfunction isSymbol(value) {\n  return typeof value == 'symbol' ||\n    (isObjectLike(value) && baseGetTag(value) == symbolTag);\n}\n\nexport default isSymbol;\n","/**\n * Checks if `value` is object-like. A value is object-like if it's not `null`\n * and has a `typeof` result of \"object\".\n *\n * @static\n * @memberOf _\n * @since 4.0.0\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is object-like, else `false`.\n * @example\n *\n * _.isObjectLike({});\n * // => true\n *\n * _.isObjectLike([1, 2, 3]);\n * // => true\n *\n * _.isObjectLike(_.noop);\n * // => false\n *\n * _.isObjectLike(null);\n * // => false\n */\nfunction isObjectLike(value) {\n  return value != null && typeof value == 'object';\n}\n\nexport default isObjectLike;\n","import isObject from './isObject.js';\nimport now from './now.js';\nimport toNumber from './toNumber.js';\n\n/** Error message constants. */\nvar FUNC_ERROR_TEXT = 'Expected a function';\n\n/* Built-in method references for those with the same name as other `lodash` methods. */\nvar nativeMax = Math.max,\n    nativeMin = Math.min;\n\n/**\n * Creates a debounced function that delays invoking `func` until after `wait`\n * milliseconds have elapsed since the last time the debounced function was\n * invoked. The debounced function comes with a `cancel` method to cancel\n * delayed `func` invocations and a `flush` method to immediately invoke them.\n * Provide `options` to indicate whether `func` should be invoked on the\n * leading and/or trailing edge of the `wait` timeout. The `func` is invoked\n * with the last arguments provided to the debounced function. Subsequent\n * calls to the debounced function return the result of the last `func`\n * invocation.\n *\n * **Note:** If `leading` and `trailing` options are `true`, `func` is\n * invoked on the trailing edge of the timeout only if the debounced function\n * is invoked more than once during the `wait` timeout.\n *\n * If `wait` is `0` and `leading` is `false`, `func` invocation is deferred\n * until to the next tick, similar to `setTimeout` with a timeout of `0`.\n *\n * See [David Corbacho's article](https://css-tricks.com/debouncing-throttling-explained-examples/)\n * for details over the differences between `_.debounce` and `_.throttle`.\n *\n * @static\n * @memberOf _\n * @since 0.1.0\n * @category Function\n * @param {Function} func The function to debounce.\n * @param {number} [wait=0] The number of milliseconds to delay.\n * @param {Object} [options={}] The options object.\n * @param {boolean} [options.leading=false]\n *  Specify invoking on the leading edge of the timeout.\n * @param {number} [options.maxWait]\n *  The maximum time `func` is allowed to be delayed before it's invoked.\n * @param {boolean} [options.trailing=true]\n *  Specify invoking on the trailing edge of the timeout.\n * @returns {Function} Returns the new debounced function.\n * @example\n *\n * // Avoid costly calculations while the window size is in flux.\n * jQuery(window).on('resize', _.debounce(calculateLayout, 150));\n *\n * // Invoke `sendMail` when clicked, debouncing subsequent calls.\n * jQuery(element).on('click', _.debounce(sendMail, 300, {\n *   'leading': true,\n *   'trailing': false\n * }));\n *\n * // Ensure `batchLog` is invoked once after 1 second of debounced calls.\n * var debounced = _.debounce(batchLog, 250, { 'maxWait': 1000 });\n * var source = new EventSource('/stream');\n * jQuery(source).on('message', debounced);\n *\n * // Cancel the trailing debounced invocation.\n * jQuery(window).on('popstate', debounced.cancel);\n */\nfunction debounce(func, wait, options) {\n  var lastArgs,\n      lastThis,\n      maxWait,\n      result,\n      timerId,\n      lastCallTime,\n      lastInvokeTime = 0,\n      leading = false,\n      maxing = false,\n      trailing = true;\n\n  if (typeof func != 'function') {\n    throw new TypeError(FUNC_ERROR_TEXT);\n  }\n  wait = toNumber(wait) || 0;\n  if (isObject(options)) {\n    leading = !!options.leading;\n    maxing = 'maxWait' in options;\n    maxWait = maxing ? nativeMax(toNumber(options.maxWait) || 0, wait) : maxWait;\n    trailing = 'trailing' in options ? !!options.trailing : trailing;\n  }\n\n  function invokeFunc(time) {\n    var args = lastArgs,\n        thisArg = lastThis;\n\n    lastArgs = lastThis = undefined;\n    lastInvokeTime = time;\n    result = func.apply(thisArg, args);\n    return result;\n  }\n\n  function leadingEdge(time) {\n    // Reset any `maxWait` timer.\n    lastInvokeTime = time;\n    // Start the timer for the trailing edge.\n    timerId = setTimeout(timerExpired, wait);\n    // Invoke the leading edge.\n    return leading ? invokeFunc(time) : result;\n  }\n\n  function remainingWait(time) {\n    var timeSinceLastCall = time - lastCallTime,\n        timeSinceLastInvoke = time - lastInvokeTime,\n        timeWaiting = wait - timeSinceLastCall;\n\n    return maxing\n      ? nativeMin(timeWaiting, maxWait - timeSinceLastInvoke)\n      : timeWaiting;\n  }\n\n  function shouldInvoke(time) {\n    var timeSinceLastCall = time - lastCallTime,\n        timeSinceLastInvoke = time - lastInvokeTime;\n\n    // Either this is the first call, activity has stopped and we're at the\n    // trailing edge, the system time has gone backwards and we're treating\n    // it as the trailing edge, or we've hit the `maxWait` limit.\n    return (lastCallTime === undefined || (timeSinceLastCall >= wait) ||\n      (timeSinceLastCall < 0) || (maxing && timeSinceLastInvoke >= maxWait));\n  }\n\n  function timerExpired() {\n    var time = now();\n    if (shouldInvoke(time)) {\n      return trailingEdge(time);\n    }\n    // Restart the timer.\n    timerId = setTimeout(timerExpired, remainingWait(time));\n  }\n\n  function trailingEdge(time) {\n    timerId = undefined;\n\n    // Only invoke if we have `lastArgs` which means `func` has been\n    // debounced at least once.\n    if (trailing && lastArgs) {\n      return invokeFunc(time);\n    }\n    lastArgs = lastThis = undefined;\n    return result;\n  }\n\n  function cancel() {\n    if (timerId !== undefined) {\n      clearTimeout(timerId);\n    }\n    lastInvokeTime = 0;\n    lastArgs = lastCallTime = lastThis = timerId = undefined;\n  }\n\n  function flush() {\n    return timerId === undefined ? result : trailingEdge(now());\n  }\n\n  function debounced() {\n    var time = now(),\n        isInvoking = shouldInvoke(time);\n\n    lastArgs = arguments;\n    lastThis = this;\n    lastCallTime = time;\n\n    if (isInvoking) {\n      if (timerId === undefined) {\n        return leadingEdge(lastCallTime);\n      }\n      if (maxing) {\n        // Handle invocations in a tight loop.\n        clearTimeout(timerId);\n        timerId = setTimeout(timerExpired, wait);\n        return invokeFunc(lastCallTime);\n      }\n    }\n    if (timerId === undefined) {\n      timerId = setTimeout(timerExpired, wait);\n    }\n    return result;\n  }\n  debounced.cancel = cancel;\n  debounced.flush = flush;\n  return debounced;\n}\n\nexport default debounce;\n","import * as model from './model.js';\nimport * as mapView from './views/map-view.js';\nimport * as formView from './views/form-view.js';\nimport * as markerView from './views/marker-view.js';\nimport * as popupView from './views/popup-view.js';\nimport * as pageView from './views/page-view.js';\nimport * as filterView from './views/filter-view.js';\nimport debounce from '../../node_modules/lodash-es/debounce.js';\n\nconst RERENDER_DELAY = 500;\nconst ADS_MAX = 10;\n\nconst controlForm = function () {};\n\nconst controlMap = function () {\n  mapView.centerMap();\n  markerView.renderMarkerMain(mapView.markerMain);\n\n  formView.toggleFormsEnability();\n};\n\nconst controlMarkerMainMove = function () {\n  const coords = mapView.markerMain.getLatLng();\n  console.log('atata');\n  formView.setAddressValue(coords);\n};\n\nconst controlPopup = function (event) {\n  const clickedMarker = event.propagatedFrom;\n  const clickedAd = model.state.ads.find((ad) => {\n    if (\n      ad.location.lat === clickedMarker.getLatLng().lat &&\n      ad.location.lng === clickedMarker.getLatLng().lng\n    ) {\n      return true;\n    }\n  });\n  popupView.renderPopup(clickedMarker, clickedAd);\n};\n\nconst controlMarker = async function () {\n  try {\n    await model.loadAds();\n    const currentAds = model.state.ads.slice(0, ADS_MAX);\n    markerView.renderMarkers(currentAds);\n  } catch (err) {\n    mapView.renderErrorLoadAds();\n  }\n};\n\nconst controlSubmit = async function (evt) {\n  try {\n    evt.preventDefault();\n    const data = new FormData(evt.target);\n    await model.sendAds(data);\n\n    const coords = { lat: mapView.LAT, lng: mapView.LNG };\n    pageView.renderSuccess();\n    formView.refresh();\n    filterView.refresh();\n    mapView.centerMap();\n    mapView.markerMain.setLatLng(coords);\n  } catch (err) {\n    pageView.renderError();\n  }\n};\n\nconst controlFilterChange = function () {\n  const filterMask = filterView.getFilterMask();\n  const filteredAds = model.filterAds(filterMask).slice(0, ADS_MAX);\n\n  mapView.markerGroup.clearLayers();\n  mapView.map.closePopup();\n  mapView.centerMap();\n  markerView.renderMarkers(filteredAds);\n};\n\nconst controlButtonReset = function () {\n  mapView.centerMap();\n  formView.refresh();\n  filterView.refresh();\n  mapView.markerMain.setLatLng({ lat: mapView.LAT, lng: mapView.LNG });\n};\n\nconst init = function () {\n  formView.addHandlerToggle(controlForm);\n  mapView.addHandlerLoad(controlMap);\n  markerView.addHandlerShowPopup(controlPopup);\n  mapView.addHandlerAttachInput(controlMarkerMainMove);\n  mapView.addHandlerRenderMarker(controlMarker);\n  formView.addHandlerSubmit(controlSubmit);\n  formView.addHandlerButtonReset(controlButtonReset);\n  filterView.addHandlerChange(debounce(controlFilterChange, RERENDER_DELAY));\n};\n\ninit();\n"],"sourceRoot":""}